<div class="card p-4 mb-5">
    <h4 class="text-center">Edit Flight {{findFlight.flightNumber}}</h4>
    <form id="flightForm" class="row g-3" action="/manage-flights/edit/{{findFlight.flightNumber}}" method="POST">

    <div class="col-md-4">
        <label class="form-label">Flight Number</label>
        <input type="text" id="flightNumber" name="flightNumber" class="form-control" required value="{{findFlight.flightNumber}}"></input>
    </div>

    <div class="col-md-4">
        <label class="form-label">Origin</label>
        <p>Current Origin: {{findFlight.origin}}</p>
        <select id="origin" class="form-select" name="origin" required>
            <option value="">Select an Origin</option>
            {{#each origins}}
                <option value="{{this}}">{{this}}</option>
            {{/each}}
        </select>
    </div>

    <div class="col-md-4">
        <label class="form-label">Destination</label>
        <p>Current Destination: {{findFlight.destination}}</p>
        <select id="destination" class="form-select" name="destination" required>
            <option value="">Select a Destination</option>
        </select>
    </div>

    <div class="col-md-4">
        <label class="form-label">Schedule</label>

        <p>Current Schedule: {{findFlight.daysOfWeek}}</p>
        <select id="daysOfWeek" class="form-select" name="daysOfWeek" multiple required size="3">
            <option value="">Select Days</option>
            <option>Monday</option>
            <option>Tuesday</option>
            <option>Wednesday</option>
            <option>Thursday</option>
            <option>Friday</option>
            <option>Saturday</option>
            <option>Sunday</option>
        </select>

        <input type="time" id="departure" class="form-control mt-2" name="departure" required value="{{findFlight.departure}}"></input>
        <input type="time" id="arrival" class="form-control mt-2" name="arrival" required value="{{findFlight.arrival}}"></input>
    </div>

    <div class="col-md-4">
        <label class="form-label">Aircraft Type</label>
        <select id="aircraft" class="form-select" name="aircraft" required>
            <option value="">Select an Aircraft</option>
        </select>
    </div>

    <div class="col-md-4">
        <label class="form-label">Seat Capacity</label>
        <input type="number" id="capacity" class="form-control" min="1" name="capacity" required value="{{findFlight.capacity}}"></input>
    </div>

    <div class="col-md-4">
        <label class="form-label">Price</label>
        <input type="number" id="price" class="form-control" name="price" required value="{{findFlight.price}}"></input>
    </div>

    <div class="col-12 d-flex justify-content-end">
        <button type="submit" class="btn btn-success me-2">Edit Flight</button>
    </div>
    </form>
<script>
    // âœ” Accept from Express backend
    const destinations = {{{json destinations}}};
    const aircraftByOrigin = {{{json aircraftByOrigin}}};

    //Function for loading the corresponding destinations and aircrafts, depending on the chosen origin
    $("#origin").on("change", function() {
        const origin = $(this).val();
        const destSelect = $("#destination");
        const aircraftSelect = $("#aircraft");

        //Gives destination options, depending on chosen origin
        if (destinations[origin]) {
            destinations[origin].forEach(dest => {
                destSelect.append(`<option value="${dest}">${dest}</option>`);
            });
        }

        //Gives aircraft options, depending on chosen origin
        if (aircraftByOrigin[origin]) {
            aircraftByOrigin[origin].forEach(plane => {
                aircraftSelect.append(`<option value="${plane}">${plane}</option>`);
            });
        }
    });
</script>
</div>